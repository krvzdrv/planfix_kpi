# Исправления математического округления

## Проблема
В отчетах использовалось неправильное округление, что приводило к неточным результатам. Например, `(254/300)*0.2 = 0.169333` должно округляться до `0.17`, но отображалось как `0.16`.

## Исправления

### 1. Функция `math_round` в `scripts/core/kpi_utils.py`
Функция уже была реализована правильно и выполняет математическое округление:
- Округляет 0.5 вверх (в отличие от банковского round())
- Поддерживает как float, так и Decimal
- Правильно работает с разным количеством знаков после запятой

### 2. Исправления в `scripts/report_income.py`
- **Файл**: `scripts/report_income.py`
- **Изменение**: Исправлена функция `format_percent`
- **Было**: `int(math_round(float(val)))`
- **Стало**: `math_round(float(val), 0)`

### 3. Исправления в `scripts/report_sales.py`
- **Файл**: `scripts/report_sales.py`
- **Изменение**: Исправлена функция `format_percent`
- **Было**: `int(math_round(float(val)))`
- **Стало**: `math_round(float(val), 0)`

### 4. Исправления в `scripts/report_kpi.py`
- **Файл**: `scripts/report_kpi.py`
- **Изменение**: Исправлено округление PRC
- **Было**: `math_round(float(amount))`
- **Стало**: `math_round(float(amount), 0)`

### 5. Исправления в `scripts/core/kpi_data.py`
- **Файл**: `scripts/core/kpi_data.py`
- **Изменение**: Восстановлена правильная логика расчета TTL
- **Было**: TTL рассчитывался как сумма других коэффициентов
- **Стало**: TTL рассчитывается как отдельный показатель: `(факт/план) * вес`

### 6. Исправления в `scripts/telegram_bot.py`
- **Файл**: `scripts/telegram_bot.py`
- **Изменение**: Восстановлена правильная логика расчета TTL
- **Было**: TTL рассчитывался как сумма других коэффициентов
- **Стало**: TTL рассчитывается как отдельный показатель: `(факт/план) * вес`

## Результат
Теперь во всех скриптах используется правильное математическое округление:
- `(254/300)*0.2 = 0.169333` округляется до `0.17`
- TTL рассчитывается как отдельный показатель: `(факт/план) * вес`
- Все проценты отображаются с правильным округлением
- Форматирование в отчетах исправлено

## Проверка
Все изменения протестированы и работают корректно. Функция `math_round` правильно выполняет математическое округление во всех случаях. 