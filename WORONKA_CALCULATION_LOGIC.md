# –õ–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –∑–Ω–∞—á–µ–Ω–∏–π –≤ –æ—Ç—á–µ—Ç–µ WORONKA

## –†–∞–∑–±–æ—Ä –ø—Ä–∏–º–µ—Ä–∞: `WTR ‚ñà‚ñà     40  +2 ‚ñ≤   [+2/-0] 10%`

### üìä **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Ç—Ä–æ–∫–∏:**
```
WTR ‚ñà‚ñà     40  +2 ‚ñ≤   [+2/-0] 10%
‚îÇ   ‚îÇ      ‚îÇ   ‚îÇ  ‚îÇ   ‚îÇ      ‚îÇ
‚îÇ   ‚îÇ      ‚îÇ   ‚îÇ  ‚îÇ   ‚îÇ      ‚îî‚îÄ –ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –æ–±—â–µ–π —Å—É–º–º—ã
‚îÇ   ‚îÇ      ‚îÇ   ‚îÇ  ‚îÇ   ‚îî‚îÄ –î–Ω–µ–≤–Ω–æ–π –ø—Ä–∏—Ç–æ–∫/–æ—Ç—Ç–æ–∫ [IN/OUT]
‚îÇ   ‚îÇ      ‚îÇ   ‚îÇ  ‚îî‚îÄ –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è
‚îÇ   ‚îÇ      ‚îÇ   ‚îî‚îÄ –ß–∏—Å—Ç–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ (net)
‚îÇ   ‚îÇ      ‚îî‚îÄ –¢–µ–∫—É—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∏–µ–Ω—Ç–æ–≤
‚îÇ   ‚îî‚îÄ –ü—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –±–∞—Ä
‚îî‚îÄ –°—Ç–∞—Ç—É—Å –∫–ª–∏–µ–Ω—Ç–∞
```

---

## üî¢ **–†–∞—Å—á–µ—Ç –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è:**

### 1. **CURRENT (40)** - –¢–µ–∫—É—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
**–ò—Å—Ç–æ—á–Ω–∏–∫:** `planfix_clients.status_wspolpracy`

**–õ–æ–≥–∏–∫–∞:**
```sql
SELECT status_wspolpracy, data_ostatniego_zamowienia 
FROM planfix_clients 
WHERE menedzer = 'Stukalo Nazarii' 
  AND is_deleted = false 
  AND status_wspolpracy IS NOT NULL
```

**–û–±—Ä–∞–±–æ—Ç–∫–∞:**
- `status_wspolpracy = 'W trakcie'` ‚Üí `WTR`
- –ü–æ–¥—Å—á–µ—Ç –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å —ç—Ç–∏–º —Å—Ç–∞—Ç—É—Å–æ–º –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** 40 –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ —Å—Ç–∞—Ç—É—Å–µ "W trakcie"

### 2. **NET (+2)** - –ß–∏—Å—Ç–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ
**–õ–æ–≥–∏–∫–∞ –¥–ª—è WTR:**
```python
# –î–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤ –∫—Ä–æ–º–µ STL/NAK - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–Ω–µ–≤–Ω–æ–π –ø—Ä–∏—Ç–æ–∫
diff = inflow  # +2
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- WTR –Ω–µ –≤—Ö–æ–¥–∏—Ç –≤ STL/NAK, –ø–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–¥–Ω–µ–≤–Ω–æ–π –ø—Ä–∏—Ç–æ–∫**
- `+2` –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Å–µ–≥–æ–¥–Ω—è 2 –∫–ª–∏–µ–Ω—Ç–∞ –ø–µ—Ä–µ—à–ª–∏ –≤ —Å—Ç–∞—Ç—É—Å "W trakcie"

### 3. **DIRECTION (‚ñ≤)** - –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
**–õ–æ–≥–∏–∫–∞:**
```python
direction = "‚ñ≤" if diff > 0 else ("‚ñº" if diff < 0 else "-")
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- `diff = +2` (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ) ‚Üí `‚ñ≤` (—Ä–æ—Å—Ç)
- `diff = -5` (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ) ‚Üí `‚ñº` (—Å–Ω–∏–∂–µ–Ω–∏–µ)  
- `diff = 0` (–Ω–æ–ª—å) ‚Üí `-` (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)

### 4. **INFLOW/OUTFLOW ([+2/-0])** - –î–Ω–µ–≤–Ω–æ–π –ø—Ä–∏—Ç–æ–∫/–æ—Ç—Ç–æ–∫
**–ò—Å—Ç–æ—á–Ω–∏–∫:** `planfix_clients.data_dodania_do_w_trakcie`

#### **INFLOW (+2)** - –î–Ω–µ–≤–Ω–æ–π –ø—Ä–∏—Ç–æ–∫
**–õ–æ–≥–∏–∫–∞:**
```sql
SELECT COUNT(*) 
FROM planfix_clients 
WHERE menedzer = 'Stukalo Nazarii'
  AND data_dodania_do_w_trakcie IS NOT NULL 
  AND data_dodania_do_w_trakcie != ''
  AND TO_DATE(data_dodania_do_w_trakcie, 'DD-MM-YYYY') = '2024-10-19'
  AND is_deleted = false
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- –°—á–∏—Ç–∞–µ–º –∫–ª–∏–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ **—Å–µ–≥–æ–¥–Ω—è** –ø–µ—Ä–µ—à–ª–∏ –≤ —Å—Ç–∞—Ç—É—Å "W trakcie"
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** 2 –∫–ª–∏–µ–Ω—Ç–∞ –¥–æ–±–∞–≤–∏–ª–∏—Å—å —Å–µ–≥–æ–¥–Ω—è

#### **OUTFLOW (-0)** - –î–Ω–µ–≤–Ω–æ–π –æ—Ç—Ç–æ–∫
**–õ–æ–≥–∏–∫–∞:**
```sql
SELECT COUNT(*) 
FROM planfix_clients 
WHERE menedzer = 'Stukalo Nazarii'
  AND data_dodania_do_w_trakcie IS NOT NULL 
  AND data_dodania_do_w_trakcie != ''
  AND TO_DATE(data_dodania_do_w_trakcie, 'DD-MM-YYYY') < '2024-10-19'
  AND TO_DATE(data_dodania_do_w_trakcie, 'DD-MM-YYYY') >= '2024-10-18'
  AND is_deleted = false
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- –°—á–∏—Ç–∞–µ–º –∫–ª–∏–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ **–≤—á–µ—Ä–∞** –±—ã–ª–∏ –≤ —Å—Ç–∞—Ç—É—Å–µ "W trakcie", –Ω–æ **—Å–µ–≥–æ–¥–Ω—è** —É–∂–µ –Ω–µ –≤ –Ω–µ–º
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** 0 –∫–ª–∏–µ–Ω—Ç–æ–≤ —É—à–ª–æ –∏–∑ —Å—Ç–∞—Ç—É—Å–∞

### 5. **PERCENT (10%)** - –ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –æ–±—â–µ–π —Å—É–º–º—ã
**–õ–æ–≥–∏–∫–∞:**
```python
total_sum = 40 + 9 + 4 + 8 + 18 + 17 + 9 + 7 + 0 = 112
percentage = (40 / 112) * 100 = 35.7% ‚Üí 36%
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- WTR —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 40 –∏–∑ 112 –æ–±—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** 36% –æ—Ç –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞

---

## üîÑ **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ç–∞—Ç—É—Å–æ–≤:**

### **STL/NAK (Stali klienci/Nieaktywni)**
**–û—Å–æ–±–∞—è –ª–æ–≥–∏–∫–∞:**
```python
if status in ['STL', 'NAK']:
    # –î–∏–Ω–∞–º–∏–∫–∞ –¥–ª—è STL/NAK - —á–∏—Å—Ç–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ —Å–æ –≤—á–µ—Ä–∞
    prev_count = previous_stl_nak.get(status, 0)
    diff = curr_count - prev_count
else:
    # –î–∏–Ω–∞–º–∏–∫–∞ –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö - –¥–Ω–µ–≤–Ω–æ–π –ø—Ä–∏—Ç–æ–∫
    diff = inflow
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- **STL/NAK** —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ **–∏—Å—Ç–æ—Ä–∏–∏** (—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–æ –≤—á–µ—Ä–∞)
- **–û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã** —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ **–¥–Ω–µ–≤–Ω–æ–≥–æ –ø—Ä–∏—Ç–æ–∫–∞**

### **STL vs NAK**
**–õ–æ–≥–∏–∫–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è:**
```python
if status_clean == 'Stali klienci':
    days_diff = (today - last_order_date).days
    short_status = 'STL' if days_diff <= 30 else 'NAK'
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- **STL** - –∫–ª–∏–µ–Ω—Ç—ã —Å –∑–∞–∫–∞–∑–æ–º ‚â§ 30 –¥–Ω–µ–π –Ω–∞–∑–∞–¥
- **NAK** - –∫–ª–∏–µ–Ω—Ç—ã —Å –∑–∞–∫–∞–∑–æ–º > 30 –¥–Ω–µ–π –Ω–∞–∑–∞–¥

---

## üìã **–°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª–µ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:**

| –°—Ç–∞—Ç—É—Å | –ü–æ–ª–µ –¥–∞—Ç—ã –≤—Ö–æ–¥–∞ | –ü–æ–ª–µ –¥–∞—Ç—ã –≤—ã—Ö–æ–¥–∞ |
|--------|-----------------|------------------|
| NWI | `data_dodania_do_nowi` | - |
| WTR | `data_dodania_do_w_trakcie` | - |
| PSK | `data_dodania_do_perspektywiczni` | - |
| PIZ | `data_pierwszego_zamowienia` | - |
| REZ | `data_dodania_do_rezygnacja` | - |
| BRK | `data_dodania_do_brak_kontaktu` | - |
| ARC | `data_dodania_do_archiwum` | - |
| STL/NAK | - | `data_ostatniego_zamowienia` |

---

## üéØ **–ò—Ç–æ–≥–æ–≤–∞—è –ª–æ–≥–∏–∫–∞:**

### **–î–ª—è WTR –≤ –ø—Ä–∏–º–µ—Ä–µ:**
1. **CURRENT (40)** - –≤—Å–µ–≥–æ –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ —Å—Ç–∞—Ç—É—Å–µ "W trakcie"
2. **NET (+2)** - –¥–Ω–µ–≤–Ω–æ–π –ø—Ä–∏—Ç–æ–∫ (2 –∫–ª–∏–µ–Ω—Ç–∞ –¥–æ–±–∞–≤–∏–ª–∏—Å—å —Å–µ–≥–æ–¥–Ω—è)
3. **DIRECTION (‚ñ≤)** - —Ä–æ—Å—Ç (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ)
4. **INFLOW (+2)** - 2 –∫–ª–∏–µ–Ω—Ç–∞ –ø–µ—Ä–µ—à–ª–∏ –≤ —Å—Ç–∞—Ç—É—Å —Å–µ–≥–æ–¥–Ω—è
5. **OUTFLOW (-0)** - 0 –∫–ª–∏–µ–Ω—Ç–æ–≤ —É—à–ª–æ –∏–∑ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ–≥–æ–¥–Ω—è
6. **PERCENT (10%)** - –¥–æ–ª—è –æ—Ç –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤

### **–§–æ—Ä–º—É–ª–∞ NET –¥–ª—è WTR:**
```
NET = INFLOW - OUTFLOW = 2 - 0 = +2
```

### **–§–æ—Ä–º—É–ª–∞ NET –¥–ª—è STL/NAK:**
```
NET = CURRENT_TODAY - CURRENT_YESTERDAY
```

–≠—Ç–∞ –ª–æ–≥–∏–∫–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ç–æ—á–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –¥–∏–Ω–∞–º–∏–∫–∏ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –±–∞–∑—ã –ø–æ –∫–∞–∂–¥–æ–º—É —Å—Ç–∞—Ç—É—Å—É! üìà
