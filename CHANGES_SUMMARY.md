# –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ KPI

## –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ Render)

### üöÄ –ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ Render Webhook

–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–∞ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –∫–æ–º–∞–Ω–¥ —á–µ—Ä–µ–∑ Render webhook –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ –±–æ—Ç–∞.

#### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:
- `api/telegram_webhook.py` - Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è Render
- `scripts/report_bonus_previous.py` - –æ—Ç—á–µ—Ç –∑–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Å—è—Ü
- `scripts/setup_telegram_webhook.py` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ webhook
- `scripts/test_render_webhook.py` - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ webhook
- `render.yaml` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Render
- `RENDER_SETUP.md` - –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

#### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
- `.github/workflows/telegram-dispatch.yml` - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–±–µ–∏—Ö –∫–æ–º–∞–Ω–¥
- `README.md` - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ Render
- `scripts/telegram_bot.py` - –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ deprecated

#### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:
```
Telegram Bot ‚Üí Render Webhook ‚Üí GitHub API ‚Üí GitHub Actions ‚Üí –û—Ç—á–µ—Ç ‚Üí Telegram
```

#### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∫–æ–º–∞–Ω–¥—ã:
- `/premia_current` - –æ—Ç—á–µ—Ç –∑–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü
- `/premia_previous` - –æ—Ç—á–µ—Ç –∑–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Å—è—Ü

### üîß –£–ª—É—á—à–µ–Ω–∏—è webhook

- –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –î–æ–±–∞–≤–ª–µ–Ω—ã health check endpoints
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–±–µ–∏—Ö –∫–æ–º–∞–Ω–¥ –ø—Ä–µ–º–∏–∏
- –ü–µ—Ä–µ–¥–∞—á–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –≤ GitHub Actions

### üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- Health check: `/health`
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä–≤–∏—Å–µ: `/`
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Render Dashboard
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± —É—Å–ø–µ—Ö–µ/–æ—à–∏–±–∫–∞—Ö

## –ü—Ä–µ–¥—ã–¥—É—â–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ core –º–æ–¥—É–ª–µ–π

–°–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –ª–æ–≥–∏–∫–∏:

#### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:
- `scripts/core/kpi_data.py` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ KPI –¥–∞–Ω–Ω—ã—Ö
- `scripts/core/kpi_report.py` - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤
- `scripts/core/kpi_utils.py` - —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è KPI
- `scripts/core/test_kpi.py` - —Ç–µ—Å—Ç—ã –¥–ª—è KPI

#### –£–ª—É—á—à–µ–Ω–∏—è:
- –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- –£–ª—É—á—à–µ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ë–æ–ª–µ–µ —á–∏—Å—Ç—ã–π –∫–æ–¥

### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è GitHub Actions

#### –ù–æ–≤—ã–µ workflows:
- `send_all_reports.yml` - –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –æ—Ç—á–µ—Ç–æ–≤
- `planfix-manual-sync.yml` - —Ä—É—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
- `report-manual-send.yml` - —Ä—É—á–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á–µ—Ç–æ–≤
- `telegram-dispatch.yml` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ Telegram

#### –§—É–Ω–∫—Ü–∏–∏:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –≤ 19:00 –ø–æ –≤–∞—Ä—à–∞–≤—Å–∫–æ–º—É –≤—Ä–µ–º–µ–Ω–∏
- –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ GitHub Actions
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### –£–ª—É—á—à–µ–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤

#### –ù–æ–≤—ã–µ —Ç–∏–ø—ã –æ—Ç—á–µ—Ç–æ–≤:
- –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (`report_activity.py`)
- KPI –æ—Ç—á–µ—Ç—ã (`report_kpi.py`)
- –û—Ç—á–µ—Ç—ã –ø–æ –ø—Ä–µ–º–∏—è–º (`report_bonus.py`)
- –û—Ç—á–µ—Ç—ã –ø–æ –¥–æ—Ö–æ–¥—É (`report_income.py`)
- –°—Ç–∞—Ç—É—Å –∫–ª–∏–µ–Ω—Ç–æ–≤ (`report_status.py`)

#### –§–æ—Ä–º–∞—Ç—ã:
- Markdown –¥–ª—è Telegram
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
- –¶–≤–µ—Ç–æ–≤–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –≠–º–æ–¥–∑–∏ –¥–ª—è –ª—É—á—à–µ–≥–æ –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞:
- –¢–∞–±–ª–∏—Ü–∞ `kpi_metrics` - –ø–ª–∞–Ω–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
- –¢–∞–±–ª–∏—Ü—ã `planfix_*` - –¥–∞–Ω–Ω—ã–µ –∏–∑ Planfix
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ API

#### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:
- Supabase –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–∞—è –ë–î
- Planfix API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

#### –§–∞–π–ª—ã:
- `scripts/config.py` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
- `.env` - –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `requirements.txt` - –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python

#### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
- Planfix API –∫–ª—é—á–∏
- Supabase –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- Telegram Bot —Ç–æ–∫–µ–Ω—ã
- GitHub —Ç–æ–∫–µ–Ω—ã

## –ü–ª–∞–Ω—ã –Ω–∞ –±—É–¥—É—â–µ–µ

### –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–∏–ø–æ–≤ –æ—Ç—á–µ—Ç–æ–≤
- –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ KPI –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
- –£–ª—É—á—à–µ–Ω–∏–µ UI –æ—Ç—á–µ—Ç–æ–≤
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏ –¥–∏–∞–≥—Ä–∞–º–º
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è:
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- –£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã 